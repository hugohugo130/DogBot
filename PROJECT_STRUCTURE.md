# DogBot å°ˆæ¡ˆçµæ§‹å®Œæ•´èªªæ˜æ–‡æª”

> **ç‰ˆæœ¬**: 1.0.0
> **æœ€å¾Œæ›´æ–°**: 2026/2/2
> **ä½œè€…**: BAILUCODE AI IDE
> **å°ˆæ¡ˆé¡å‹**: Discord Bot (Node.js)

---

## ğŸ“‹ ç›®éŒ„

1. [å°ˆæ¡ˆæ¦‚è¿°](#å°ˆæ¡ˆæ¦‚è¿°)
2. [æŠ€è¡“æ¶æ§‹](#æŠ€è¡“æ¶æ§‹)
3. [æ ¸å¿ƒç³»çµ±](#æ ¸å¿ƒç³»çµ±)
4. [ç›®éŒ„çµæ§‹è©³è§£](#ç›®éŒ„çµæ§‹è©³è§£)
5. [å•Ÿå‹•æµç¨‹](#å•Ÿå‹•æµç¨‹)
6. [åŠŸèƒ½æ¨¡çµ„èªªæ˜](#åŠŸèƒ½æ¨¡çµ„èªªæ˜)
7. [è³‡æ–™åº«ç³»çµ±](#è³‡æ–™åº«ç³»çµ±)
8. [é–‹ç™¼æŒ‡å—](#é–‹ç™¼æŒ‡å—)

---

## å°ˆæ¡ˆæ¦‚è¿°

### ğŸ¯ å°ˆæ¡ˆç°¡ä»‹

DogBot æ˜¯ä¸€å€‹åŠŸèƒ½è±å¯Œçš„ Discord æ©Ÿå™¨äººï¼Œä¸»è¦æä¾›ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š

- **ğŸ® RPG éŠæˆ²ç³»çµ±**: å®Œæ•´çš„è§’è‰²æ‰®æ¼”éŠæˆ²ï¼ŒåŒ…å«è·æ¥­ã€ç‰©å“ã€è£½ä½œã€äº¤æ˜“ç­‰ç³»çµ±
- **ğŸµ éŸ³æ¨‚æ’­æ”¾ç³»çµ±**: æ”¯æ´å¤šå¹³å°éŸ³æ¨‚ä¸²æµæ’­æ”¾ï¼ˆSoundCloudã€Jamendo ç­‰ï¼‰
- **âš™ï¸ ä¼ºæœå™¨ç®¡ç†**: å‹•æ…‹èªéŸ³é »é“ã€å‰ç¶´è¨­å®šã€æ¬Šé™ç®¡ç†
- **ğŸ“Š è³‡æ–™æŒä¹…åŒ–**: JSON æª”æ¡ˆç³»çµ± + ç·šä¸Šå‚™ä»½ç³»çµ±
- **ğŸ”„ æ’ç¨‹ä»»å‹™**: å®šæ™‚åŸ·è¡Œç¶­è­·ä»»å‹™

### ğŸ› ï¸ æŠ€è¡“æ£§

| é¡åˆ¥ | æŠ€è¡“ |
|------|------|
| **é‹è¡Œç’°å¢ƒ** | Node.js (CommonJS) |
| **æ ¸å¿ƒæ¡†æ¶** | Discord.js v14.25.1 |
| **èªéŸ³è™•ç†** | @discordjs/voice v0.19.0, @discordjs/opus |
| **è³‡æ–™åº«** | JSON æª”æ¡ˆç³»çµ± |
| **éŸ³è¨Šè™•ç†** | FFmpeg, fluent-ffmpeg, prism-media |
| **éŸ³æ¨‚ä¾†æº** | soundcloud.ts, Jamendo API |
| **æ—¥èªŒç³»çµ±** | Winston v3.19.0 |
| **HTTP æœå‹™** | Express v5.2.1 |
| **å…¶ä»–å·¥å…·** | axios, file-type, diff |

### ğŸ“¦ ä¾è³´èªªæ˜

```json
{
  "discord.js": "è™•ç† Discord API äº’å‹•",
  "@discordjs/voice": "èªéŸ³é »é“é€£æ¥èˆ‡éŸ³è¨Šæ’­æ”¾",
  "winston": "çµæ§‹åŒ–æ—¥èªŒè¨˜éŒ„",
  "soundcloud.ts": "SoundCloud éŸ³æ¨‚æœå°‹èˆ‡ä¸²æµ",
  "fluent-ffmpeg": "éŸ³è¨Šæ ¼å¼è½‰æ›",
  "express": "å…§å»º HTTP ä¼ºæœå™¨",
  "axios": "HTTP è«‹æ±‚è™•ç†"
}
```

---

## æŠ€è¡“æ¶æ§‹

### ğŸ—ï¸ ç³»çµ±æ¶æ§‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        DogBot ç³»çµ±                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   Discord    â”‚  â”‚   Express    â”‚  â”‚   Database   â”‚      â”‚
â”‚  â”‚   Client     â”‚  â”‚   Server     â”‚  â”‚    (JSON)    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â”‚                  â”‚                  â”‚               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚              æ ¸å¿ƒäº‹ä»¶è™•ç†å±¤ (Cogs)                  â”‚     â”‚
â”‚  â”‚  â€¢ handle_slashcmd  â€¢ on_ready  â€¢ rpg_handler     â”‚     â”‚
â”‚  â”‚  â€¢ dynamicVoice     â€¢ dailySign â€¢ AutoComplete     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              æŒ‡ä»¤åŸ·è¡Œå±¤ (SlashCmd)                   â”‚    â”‚
â”‚  â”‚  â”œâ”€ Music: play, pause, skip, queue...             â”‚    â”‚
â”‚  â”‚  â”œâ”€ RPG: farm, cook, bake, smelt, make...         â”‚    â”‚
â”‚  â”‚  â””â”€ Admin: prefix, setrpg, dynamicvoice...        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              å·¥å…·å±¤ (Utils)                          â”‚    â”‚
â”‚  â”‚  â”œâ”€ rpg.js: RPG éŠæˆ²é‚è¼¯                           â”‚    â”‚
â”‚  â”‚  â”œâ”€ music/: éŸ³æ¨‚æ’­æ”¾ç³»çµ±                          â”‚    â”‚
â”‚  â”‚  â”œâ”€ file.js: æª”æ¡ˆèˆ‡è³‡æ–™åº«æ“ä½œ                     â”‚    â”‚
â”‚  â”‚  â”œâ”€ logger.js: æ—¥èªŒç³»çµ±                           â”‚    â”‚
â”‚  â”‚  â””â”€ customs/: è‡ªå®šç¾©é¡åˆ¥ (Client, EmbedBuilder)   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              æ’ç¨‹ç³»çµ± (Schedule)                     â”‚    â”‚
â”‚  â”‚  â”œâ”€ everysec/: æ¯ç§’åŸ·è¡Œ                            â”‚    â”‚
â”‚  â”‚  â”œâ”€ everymin/: æ¯åˆ†é˜åŸ·è¡Œ                          â”‚    â”‚
â”‚  â”‚  â””â”€ every5min/: æ¯5åˆ†é˜åŸ·è¡Œ                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”„ äº‹ä»¶æµç¨‹

#### 1. æ©Ÿå™¨äººå•Ÿå‹•æµç¨‹

```
index.js (ä¸»ç¨‹åº)
    â†“
æª¢æŸ¥ç’°å¢ƒè®Šæ•¸ (.env)
    â†“
è¼‰å…¥è³‡æ–™åº«æª¢æŸ¥ (checkDBFilesExists)
    â†“
è¼‰å…¥ Cogs (äº‹ä»¶ç›£è½å™¨)
    â†“
è¨»å†Šæ–œç·šæŒ‡ä»¤ (registcmd)
    â†“
ç™»å…¥ Discord (client.login)
    â†“
è§¸ç™¼ ClientReady äº‹ä»¶
    â†“
å•Ÿå‹•æ’ç¨‹ç³»çµ± (run_schedule)
    â†“
æ©Ÿå™¨äººå°±ç·’ âœ“
```

#### 2. æŒ‡ä»¤åŸ·è¡Œæµç¨‹

```
ç”¨æˆ¶è¼¸å…¥æ–œç·šæŒ‡ä»¤
    â†“
Discord API æ¥æ”¶
    â†“
InteractionCreate äº‹ä»¶è§¸ç™¼
    â†“
handle_slashcmd.js (Cog) æ¥æ”¶
    â†“
é©—è­‰æ¬Šé™èˆ‡åƒæ•¸
    â†“
æŸ¥æ‰¾å°æ‡‰æŒ‡ä»¤æª”æ¡ˆ (slashcmd/...)
    â†“
åŸ·è¡ŒæŒ‡ä»¤é‚è¼¯ (execute å‡½æ•¸)
    â†“
å›å‚³çµæœçµ¦ç”¨æˆ¶
```

#### 3. RPG ç³»çµ±æµç¨‹

```
ç”¨æˆ¶åŸ·è¡Œ RPG æŒ‡ä»¤ (å¦‚ /farm)
    â†“
æª¢æŸ¥è·æ¥­æ˜¯å¦ç¬¦åˆ
    â†“
æª¢æŸ¥å†·å»æ™‚é–“
    â†“
è®€å–ç”¨æˆ¶ RPG è³‡æ–™ (load_rpg_data)
    â†“
åŸ·è¡ŒéŠæˆ²é‚è¼¯ (å·¥ä½œã€è£½ä½œç­‰)
    â†“
æ›´æ–°èƒŒåŒ…èˆ‡é‡‘å¹£
    â†“
å„²å­˜è³‡æ–™ (save_rpg_data)
    â†“
å›å‚³çµæœ Embed
```

---

## æ ¸å¿ƒç³»çµ±

### 1ï¸âƒ£ è‡ªå®šç¾© Discord Client

**æª”æ¡ˆä½ç½®**: `utils/customs/client.js`

```javascript
class DogClient extends Client {
    constructor() {
        // é…ç½® Discord.js Client
        // - è¨­å®š Intents (æ¬Šé™)
        // - é…ç½®å¿«å–ç­–ç•¥ (Sweepers)
        // - è¨­å®šé‡è©¦æ©Ÿåˆ¶
    }

    // æ ¸å¿ƒå±¬æ€§
    commands: Collection         // æ–œç·šæŒ‡ä»¤é›†åˆ
    dvoice: Collection          // å‹•æ…‹èªéŸ³é »é“è³‡æ–™
    musicTrackSession: Collection // éŸ³æ¨‚è¿½è¹¤æœƒè©±
    oven_sessions: Collection   // çƒ¤çˆæœƒè©± (RPG)
    smelter_sessions: Collection // ç†”çˆæœƒè©± (RPG)
    cook_sessions: Collection   // çƒ¹é£ªæœƒè©± (RPG)
    lock: Object               // æŒ‡ä»¤é– (é˜²æ­¢ä½µç™¼)

    // æ ¸å¿ƒæ–¹æ³•
    async getAllGuilds()        // ç²å–æ‰€æœ‰ä¼ºæœå™¨
    async getGuildMembers()     // ç²å–ä¼ºæœå™¨æˆå“¡
    async getAllGuildMembers()  // ç²å–æ‰€æœ‰æˆå“¡
}
```

**ç‰¹è‰²åŠŸèƒ½**:
- **å¿«å–ç®¡ç†**: å®šæ™‚æ¸…ç†ä¸æ´»èºçš„é »é“ã€ä¼ºæœå™¨ã€ç”¨æˆ¶å¿«å–
- **åˆ†ç‰‡æ”¯æ´**: æ”¯æ´å¤šåˆ†ç‰‡éƒ¨ç½²
- **é–æ©Ÿåˆ¶**: é˜²æ­¢ RPG æŒ‡ä»¤ä½µç™¼åŸ·è¡Œå°è‡´è³‡æ–™ä¸ä¸€è‡´

### 2ï¸âƒ£ RPG éŠæˆ²ç³»çµ±

**æª”æ¡ˆä½ç½®**: `utils/rpg.js` (1000+ è¡Œ)

#### éŠæˆ²æ•¸æ“šçµæ§‹

```javascript
// è·æ¥­ç³»çµ±
jobs = {
    fisher: { name: "æ¼å¤«", emoji: "fisher", desc: "åœ¨æµ·é‚Šé‡£é­š" },
    farmer: { name: "è¾²å¤«", emoji: "farmer", desc: "ç¨®æ¤ä½œç‰©" },
    miner: { name: "ç¤¦å·¥", emoji: "ore", desc: "æŒ–æ˜ç¤¦ç‰©" },
    lumberjack: { name: "ä¼æœ¨å·¥", emoji: "wood", desc: "ç ä¼æ¨¹æœ¨" },
    herder: { name: "ç‰§è¾²", emoji: "cow", desc: "é£¼é¤Šå‹•ç‰©" },
    blacksmith: { name: "éµåŒ ", emoji: "swords", desc: "è£½ä½œæ­¦å™¨" },
    cook: { name: "å»šå¸«", emoji: "cook", desc: "çƒ¹é£ªé£Ÿç‰©" },
    pharmacist: { name: "è—¥åŠ‘å¸«", emoji: "potion", desc: "èª¿è£½è—¥æ°´" }
}

// ç‰©å“åˆ†é¡
mine_gets: ç¤¦ç‰© (coal, diamond_ore, iron_ore...)
ingots: éŒ  (diamond, emerald, gold, iron...)
logs: åŸæœ¨ (oak_wood, birch_wood...)
planks: æœ¨æ¿ (oak_planks, birch_planks...)
foods: é£Ÿç‰© (bread, beef, potato...)
weapons_armor: æ­¦å™¨é˜²å…· (iron_sword, iron_armor...)
brew: è—¥æ°´ (regen_potion, lucky_potion...)
```

#### æ ¸å¿ƒæ©Ÿåˆ¶

**1. å†·å»ç³»çµ±**
```javascript
// æª¢æŸ¥å†·å»æ™‚é–“
is_cooldown_finished(command_name, rpg_data)
    â†’ { is_finished: boolean, remaining_time: number }

// å†·å»æ™‚é–“è¨ˆç®—
get_cooldown_time(command_name, rpg_data)
    â†’ æ ¹æ“šåŸ·è¡Œæ¬¡æ•¸å‹•æ…‹è¨ˆç®—
```

**2. åˆæˆç³»çµ±**
```javascript
recipes = {
    iron_sword: {
        input: [
            { item: "stick", amount: 1 },
            { item: "iron", amount: 3 }
        ],
        output: "iron_sword",
        amount: 1
    }
}
```

**3. ç†”ç…‰ç³»çµ±**
```javascript
smeltable_recipe = [
    {
        input: { item: "iron_ore", amount: 2 },
        output: "iron",
        amount: 1
    }
]
```

**4. ç¶“æ¿Ÿç³»çµ±**
```javascript
// å•†åº—åƒ¹æ ¼
shop_lowest_price = {
    diamond: 750,
    iron: 250,
    bread: 125,
    ...
}

// å‡ºå”®åƒ¹æ ¼ (90% å•†åº—åƒ¹)
sell_data = Object.keys(shop_lowest_price).reduce(
    (result, key) => {
        result[key] = shop_lowest_price[key] * 0.9;
        return result;
    }, {}
);
```

**5. é‡‘éŒ¢äº¤æ˜“è¿½è¹¤**
```javascript
// å¢åŠ é‡‘éŒ¢
add_money({ rpg_data, amount, originalUser, targetUser, type })
    â†’ æ›´æ–°é‡‘å¹£ä¸¦è¨˜éŒ„äº¤æ˜“æ­·å²

// æ‰£é™¤é‡‘éŒ¢
remove_money({ rpg_data, amount, originalUser, targetUser, type })
    â†’ æ›´æ–°é‡‘å¹£ä¸¦è¨˜éŒ„äº¤æ˜“æ­·å²
```

### 3ï¸âƒ£ éŸ³æ¨‚æ’­æ”¾ç³»çµ±

**æª”æ¡ˆä½ç½®**: `utils/music/music.js` (800+ è¡Œ)

#### æ ¸å¿ƒé¡åˆ¥

**MusicTrack é¡åˆ¥**
```javascript
class MusicTrack {
    id: string              // éŸ³æ¨‚ ID
    title: string           // æ¨™é¡Œ
    url: string            // ä¾†æºç¶²å€
    duration: number       // æ™‚é•· (æ¯«ç§’)
    thumbnail: string      // ç¸®åœ–
    author: string         // ä½œè€…
    source: string         // ä¾†æºå¹³å° (ç›®å‰åªæ”¯æ´soundcloud)
    stream: Readable       // éŸ³è¨Šä¸²æµ
    uuid: string           // å”¯ä¸€è­˜åˆ¥ç¢¼

    async prepareStream()  // æº–å‚™éŸ³è¨Šä¸²æµ
}
```

**MusicQueue é¡åˆ¥**
```javascript
class MusicQueue {
    guildID: string              // ä¼ºæœå™¨ ID
    tracks: MusicTrack[]         // æ’­æ”¾ä½‡åˆ—
    player: AudioPlayer          // éŸ³è¨Šæ’­æ”¾å™¨
    currentTrack: MusicTrack     // ç›®å‰æ’­æ”¾çš„éŸ³æ¨‚
    loopStatus: number           // å¾ªç’°ç‹€æ…‹ (0:é—œé–‰, 1:å–®æ›², 2:å…¨éƒ¨)
    connection: VoiceConnection  // èªéŸ³é€£æ¥
    textChannel: TextChannel     // æ–‡å­—é »é“
    voiceChannel: VoiceChannel   // èªéŸ³é »é“

    // æ ¸å¿ƒæ–¹æ³•
    async play(track)            // æ’­æ”¾éŸ³æ¨‚
    async addTrack(track)        // åŠ å…¥ä½‡åˆ—
    async nextTrack()            // ä¸‹ä¸€é¦–
    pause()                      // æš«åœ
    unpause()                    // ç¹¼çºŒ
    shuffle()                    // éš¨æ©Ÿæ’­æ”¾
    destroy()                    // éŠ·æ¯€ä½‡åˆ—
}
```

#### éŸ³æ¨‚æœå°‹å¼•æ“

æ”¯æ´å¤šå¹³å°æœå°‹ï¼š
```javascript
search_until(query, amount = 25)
    â†’ ä¾åºæœå°‹ musicSearchEngine é…ç½®çš„å¹³å°
    â†’ è¿”å› MusicTrack[]
```

**æ”¯æ´çš„ä¾†æº**:
- **SoundCloud**: `utils/music/soundcloud.js`
- **Jamendo**: `utils/music/jamendo.js`
- **ç›´æ¥éŸ³è¨Šæª”æ¡ˆ**: æ”¯æ´ç¶²å€ç›´æ¥æ’­æ”¾

### 4ï¸âƒ£ æ’ç¨‹ç³»çµ±

**æª”æ¡ˆä½ç½®**: `utils/run_schedule.js`

#### æ’ç¨‹é¡å‹

| é¡å‹ | åŸ·è¡Œé »ç‡ | ç›®éŒ„ |
|------|---------|------|
| **everysec** | æ¯ç§’ | `schedule/everysec/` |
| **everymin** | æ¯åˆ†é˜ | `schedule/everymin/` |
| **every5min** | æ¯5åˆ†é˜ | `schedule/every5min/` |

#### ç¾æœ‰æ’ç¨‹ä»»å‹™

**1. process_send_queue.js** (æ¯ç§’)
- è™•ç†è¨Šæ¯ç™¼é€ä½‡åˆ—
- é¿å… Discord API é€Ÿç‡é™åˆ¶

**2. fix_user_rpg_database.js** (æ¯5åˆ†é˜)
- ä¿®å¾©ç”¨æˆ¶ RPG è³‡æ–™åº«ç•°å¸¸
- ç¢ºä¿è³‡æ–™å®Œæ•´æ€§

**3. upload_db_files.js** (æ¯5åˆ†é˜)
- ä¸Šå‚³è³‡æ–™åº«æª”æ¡ˆè‡³ç·šä¸Šå‚™ä»½
- é˜²æ­¢è³‡æ–™éºå¤±

#### æ’ç¨‹åŸ·è¡Œæ©Ÿåˆ¶

```javascript
// ä½¿ç”¨é–æ©Ÿåˆ¶é˜²æ­¢é‡è¤‡åŸ·è¡Œ
run_lock = {}

async function scheduleFunc(client, file, per) {
    // ç­‰å¾…é–é‡‹æ”¾
    await wait_for_lock(basename, 20000)

    // ç²å–é–
    run_lock[basename] = true

    try {
        // åŸ·è¡Œæ’ç¨‹ä»»å‹™
        await schedule.execute(client)
    } finally {
        // é‡‹æ”¾é–
        run_lock[basename] = false
    }
}
```

---

## ç›®éŒ„çµæ§‹è©³è§£

```
DogBot/
â”œâ”€â”€ index.js                    # ä¸»ç¨‹å¼å…¥å£
â”œâ”€â”€ register_commands.js        # æ–œç·šæŒ‡ä»¤è¨»å†Š
â”œâ”€â”€ package.json               # å°ˆæ¡ˆé…ç½®
â”œâ”€â”€ .env                       # ç’°å¢ƒè®Šæ•¸ (éœ€è‡ªè¡Œå»ºç«‹)
â”œâ”€â”€ .env.example              # ç’°å¢ƒè®Šæ•¸ç¯„ä¾‹
â”œâ”€â”€ Dockerfile                # Docker éƒ¨ç½²é…ç½®
â”‚
â”œâ”€â”€ cogs/                     # äº‹ä»¶è™•ç†å™¨ (Cogs)
â”‚   â”œâ”€â”€ on_ready.js          # æ©Ÿå™¨äººå°±ç·’äº‹ä»¶
â”‚   â”œâ”€â”€ handle_slashcmd.js   # æ–œç·šæŒ‡ä»¤è™•ç†
â”‚   â”œâ”€â”€ AutoComplete.js      # è‡ªå‹•å®Œæˆè™•ç†
â”‚   â”œâ”€â”€ dailySign.js         # æ¯æ—¥ç°½åˆ°
â”‚   â”œâ”€â”€ dynamicVoice.js      # å‹•æ…‹èªéŸ³é »é“
â”‚   â”œâ”€â”€ getInfoByMention.js  # æåŠè³‡è¨Šå–å¾—
â”‚   â”œâ”€â”€ admin_cmds.js        # ç®¡ç†å“¡æŒ‡ä»¤
â”‚   â”œâ”€â”€ éå¤œ.js              # éå¤œç³»çµ±
â”‚   â””â”€â”€ rpg/                 # RPG ç›¸é—œäº‹ä»¶
â”‚       â”œâ”€â”€ msg_handler.js   # RPG è¨Šæ¯è™•ç†
â”‚       â””â”€â”€ interactions.js  # RPG äº’å‹•è™•ç†
â”‚
â”œâ”€â”€ slashcmd/                # æ–œç·šæŒ‡ä»¤
â”‚   â”œâ”€â”€ ping.js             # Ping æŒ‡ä»¤
â”‚   â”œâ”€â”€ info.js             # è³‡è¨ŠæŒ‡ä»¤
â”‚   â”œâ”€â”€ music/              # éŸ³æ¨‚æŒ‡ä»¤
â”‚   â”‚   â”œâ”€â”€ play.js        # æ’­æ”¾éŸ³æ¨‚
â”‚   â”‚   â”œâ”€â”€ pause.js       # æš«åœ
â”‚   â”‚   â”œâ”€â”€ resume.js      # ç¹¼çºŒ
â”‚   â”‚   â”œâ”€â”€ skip.js        # è·³é
â”‚   â”‚   â”œâ”€â”€ queue.js       # æŸ¥çœ‹ä½‡åˆ—
â”‚   â”‚   â”œâ”€â”€ nowplaying.js  # æ­£åœ¨æ’­æ”¾
â”‚   â”‚   â”œâ”€â”€ join.js        # åŠ å…¥èªéŸ³
â”‚   â”‚   â”œâ”€â”€ disconnect.js  # é›¢é–‹èªéŸ³
â”‚   â”‚   â””â”€â”€ swap.js        # äº¤æ›ä½‡åˆ—é †åº
â”‚   â”œâ”€â”€ game/rpg/           # RPG éŠæˆ²æŒ‡ä»¤
â”‚   â”‚   â”œâ”€â”€ farm.js        # è¾²è€•
â”‚   â”‚   â”œâ”€â”€ cook.js        # çƒ¹é£ª
â”‚   â”‚   â”œâ”€â”€ bake.js        # çƒ˜çƒ¤
â”‚   â”‚   â”œâ”€â”€ smelt.js       # ç†”ç…‰
â”‚   â”‚   â”œâ”€â”€ make.js        # è£½ä½œ
â”‚   â”‚   â”œâ”€â”€ setLang.js     # è¨­å®šèªè¨€
â”‚   â”‚   â””â”€â”€ admins/        # ç®¡ç†å“¡ RPG æŒ‡ä»¤
â”‚   â”‚       â””â”€â”€ getuserdata.js
â”‚   â””â”€â”€ admins/             # ç®¡ç†å“¡æŒ‡ä»¤
â”‚       â””â”€â”€ guild_only/     # ä¼ºæœå™¨é™å®š
â”‚           â”œâ”€â”€ prefix.js   # å‰ç¶´è¨­å®š
â”‚           â”œâ”€â”€ setrpg.js   # RPG è¨­å®š
â”‚           â””â”€â”€ dynamicvoice.js # å‹•æ…‹èªéŸ³è¨­å®š
â”‚
â”œâ”€â”€ utils/                   # å·¥å…·æ¨¡çµ„
â”‚   â”œâ”€â”€ rpg.js              # RPG éŠæˆ²é‚è¼¯ (1000+ è¡Œ)
â”‚   â”œâ”€â”€ config.js           # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ logger.js           # æ—¥èªŒç³»çµ±
â”‚   â”œâ”€â”€ file.js             # æª”æ¡ˆæ“ä½œ
â”‚   â”œâ”€â”€ language.js         # å¤šèªè¨€æ”¯æ´
â”‚   â”œâ”€â”€ message.js          # è¨Šæ¯è™•ç†
â”‚   â”œâ”€â”€ discord.js          # Discord å·¥å…·
â”‚   â”œâ”€â”€ random.js           # éš¨æ©Ÿå·¥å…·
â”‚   â”œâ”€â”€ timestamp.js        # æ™‚é–“æˆ³è™•ç†
â”‚   â”œâ”€â”€ cache.js            # å¿«å–ç®¡ç†
â”‚   â”œâ”€â”€ onlineDB.js         # ç·šä¸Šè³‡æ–™åº«
â”‚   â”œâ”€â”€ auto_register.js    # è‡ªå‹•è¨»å†ŠæŒ‡ä»¤
â”‚   â”œâ”€â”€ check_db_files.js   # è³‡æ–™åº«æª¢æŸ¥
â”‚   â”œâ”€â”€ check.env.js        # ç’°å¢ƒè®Šæ•¸æª¢æŸ¥
â”‚   â”œâ”€â”€ hot_reload.js       # ç†±é‡è¼‰
â”‚   â”œâ”€â”€ load_cogs.js        # è¼‰å…¥ Cogs
â”‚   â”œâ”€â”€ loadslashcmd.js     # è¼‰å…¥æ–œç·šæŒ‡ä»¤
â”‚   â”œâ”€â”€ run_schedule.js     # æ’ç¨‹åŸ·è¡Œå™¨
â”‚   â”œâ”€â”€ safeshutdown.js     # å®‰å…¨é—œé–‰
â”‚   â”œâ”€â”€ wait_until_ready.js # ç­‰å¾…å°±ç·’
â”‚   â”œâ”€â”€ sleep.js            # å»¶é²å·¥å…·
â”‚   â”œâ”€â”€ time.js             # æ™‚é–“å·¥å…·
â”‚   â”œâ”€â”€ senderr.js          # éŒ¯èª¤ç™¼é€
â”‚   â”œâ”€â”€ readline.js         # å‘½ä»¤åˆ—è¼¸å…¥
â”‚   â”œâ”€â”€ getSeverIPSync.js   # å–å¾—ä¼ºæœå™¨ IP
â”‚   â”œâ”€â”€ delete_user_all_messages.js # åˆªé™¤ç”¨æˆ¶è¨Šæ¯
â”‚   â”œâ”€â”€ customs/            # è‡ªå®šç¾©é¡åˆ¥
â”‚   â”‚   â”œâ”€â”€ client.js      # è‡ªå®šç¾© Discord Client
â”‚   â”‚   â””â”€â”€ embedBuilder.js # è‡ªå®šç¾© Embed å»ºæ§‹å™¨
â”‚   â””â”€â”€ music/              # éŸ³æ¨‚ç³»çµ±
â”‚       â”œâ”€â”€ music.js        # éŸ³æ¨‚æ ¸å¿ƒ (800+ è¡Œ)
â”‚       â”œâ”€â”€ soundcloud.js   # SoundCloud API
â”‚       â””â”€â”€ jamendo.js      # Jamendo API
â”‚
â”œâ”€â”€ schedule/               # æ’ç¨‹ä»»å‹™
â”‚   â”œâ”€â”€ everysec/          # æ¯ç§’åŸ·è¡Œ
â”‚   â”‚   â””â”€â”€ process_send_queue.js
â”‚   â”œâ”€â”€ everymin/          # æ¯åˆ†é˜åŸ·è¡Œ
â”‚   â””â”€â”€ every5min/         # æ¯5åˆ†é˜åŸ·è¡Œ
â”‚       â”œâ”€â”€ fix_user_rpg_database.js
â”‚       â””â”€â”€ upload_db_files.js
â”‚
â”œâ”€â”€ db/                    # è³‡æ–™åº«ç›®éŒ„ (éœ€è‡ªè¡Œå»ºç«‹)
â”‚   â”œâ”€â”€ guilds/           # ä¼ºæœå™¨è³‡æ–™
â”‚   â”œâ”€â”€ users/            # ç”¨æˆ¶è³‡æ–™
â”‚   â””â”€â”€ rpg/              # RPG è³‡æ–™
â”‚
â”œâ”€â”€ server/               # Express HTTP ä¼ºæœå™¨
â”‚   â””â”€â”€ index.js
â”‚
â”œâ”€â”€ database_recovery/    # è³‡æ–™åº«æ¢å¾©å·¥å…·
â”‚   â””â”€â”€ main.py          # Python æ¢å¾©è…³æœ¬
â”‚
â”œâ”€â”€ ai_update/            # AI æ›´æ–°è¨˜éŒ„
â”‚
â”œâ”€â”€ .bailurules/          # AI IDE è¦å‰‡
â”‚   â”œâ”€â”€ aiUpdateMd.md
â”‚   â””â”€â”€ toolsUsage.md
â”‚
â””â”€â”€ é–‹ç™¼å·¥å…·è…³æœ¬
    â”œâ”€â”€ check_circular_dependencies.js  # æª¢æŸ¥å¾ªç’°ä¾è³´
    â”œâ”€â”€ generateDependencyReport.js     # ç”Ÿæˆä¾è³´å ±å‘Š
    â”œâ”€â”€ downloadFile.js                 # ä¸‹è¼‰æª”æ¡ˆå·¥å…·
    â””â”€â”€ test.js                        # æ¸¬è©¦è…³æœ¬
```

---

## å•Ÿå‹•æµç¨‹

### ğŸ“ å‰ç½®æº–å‚™

1. **å®‰è£ Node.js** (å»ºè­° v18+)
2. **å®‰è£ FFmpeg** (éŸ³æ¨‚æ’­æ”¾å¿…éœ€)
3. **å»ºç«‹ Discord Bot** ä¸¦å–å¾— Token

### âš™ï¸ ç’°å¢ƒè¨­å®š

å»ºç«‹ `.env` æª”æ¡ˆï¼š
```env
TOKEN=ä½ çš„_Discord_Bot_Token
CLIENT_ID=ä½ çš„_Bot_Client_ID
```

### ğŸš€ å•Ÿå‹•æ­¥é©Ÿ

```bash
# 1. å®‰è£ä¾è³´
npm install

# 2. æª¢æŸ¥å¾ªç’°ä¾è³´ (å¯é¸)
npm run check-deps

# 3. å•Ÿå‹•æ©Ÿå™¨äºº
npm start

# 4. æ¸¬è©¦æ¨¡å¼ (å¯é¸)
npm test
```

### ğŸ³ Docker éƒ¨ç½²

```bash
# å»ºç«‹æ˜ åƒ
docker build -t dogbot .

# åŸ·è¡Œå®¹å™¨
docker run -d \
  --name dogbot \
  --env-file .env \
  -v ./db:/app/db \
  dogbot
```

### ğŸ–¥ï¸ å‘½ä»¤åˆ—æŒ‡ä»¤

æ©Ÿå™¨äººé‹è¡Œæ™‚å¯ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤ï¼š

| æŒ‡ä»¤ | åŠŸèƒ½ |
|------|------|
| `stop` | å®‰å…¨é—œé–‰æ©Ÿå™¨äºº |
| `fstop` | å¼·åˆ¶é—œé–‰ (ä¸å»ºè­°) |
| `music` | æŸ¥çœ‹éŸ³æ¨‚æ’­æ”¾å™¨ç‹€æ…‹ |
| `musicd <depth>` | è©³ç´°éŸ³æ¨‚æ’­æ”¾å™¨è³‡è¨Š |

---

## åŠŸèƒ½æ¨¡çµ„èªªæ˜

### ğŸ® RPG éŠæˆ²ç³»çµ±

#### è·æ¥­ç³»çµ±

ç©å®¶å¯é¸æ“‡ä»¥ä¸‹è·æ¥­ï¼š

| è·æ¥­ | å·¥ä½œæŒ‡ä»¤ | ç”Ÿç”¢ç‰©å“ |
|------|---------|---------|
| æ¼å¤« (Fisher) | `/fish` | ç”Ÿé­šé¡ |
| è¾²å¤« (Farmer) | `/farm` | ä½œç‰© |
| ç¤¦å·¥ (Miner) | `/mine` | ç¤¦ç‰© |
| ä¼æœ¨å·¥ (Lumberjack) | `/chop` | æœ¨æ |
| ç‰§è¾² (Herder) | `/herd` | å‹•ç‰©ç”¢å“ |
| éµåŒ  (Blacksmith) | `/make` | æ­¦å™¨é˜²å…· |
| å»šå¸« (Cook) | `/cook`, `/bake` | é£Ÿç‰© |
| è—¥åŠ‘å¸« (Pharmacist) | `/brew` | è—¥æ°´ |

#### éŠæˆ²æ©Ÿåˆ¶

**1. å·¥ä½œç³»çµ±**
- æ¯å€‹è·æ¥­æœ‰å°ˆå±¬å·¥ä½œæŒ‡ä»¤
- æœ‰å†·å»æ™‚é–“é™åˆ¶ (æ ¹æ“šåŸ·è¡Œæ¬¡æ•¸å‹•æ…‹èª¿æ•´)
- å¯èƒ½å¤±æ•— (ç‚¸å½ˆã€æš´é¢¨é›¨ã€åå¡Œç­‰äº‹ä»¶)
- æˆåŠŸå¾Œç²å¾—ç‰©å“èˆ‡ç¶“é©—

**2. è£½ä½œç³»çµ±**
- `/make`: æ ¹æ“šé…æ–¹åˆæˆç‰©å“
- `/bake`: çƒ˜çƒ¤é£Ÿç‰©
- `/smelt`: ç†”ç…‰ç¤¦çŸ³
- `/cook`: çƒ¹é£ªé£Ÿç‰©

**3. ç¶“æ¿Ÿç³»çµ±**
- å•†åº—ç³»çµ±ï¼šè²·è³£ç‰©å“
- äº¤æ˜“è¿½è¹¤ï¼šè¨˜éŒ„æ‰€æœ‰é‡‘éŒ¢æµå‹•
- åƒ¹æ ¼æ©Ÿåˆ¶ï¼šè²·åƒ¹èˆ‡è³£åƒ¹ (90%)

**4. èƒŒåŒ…ç³»çµ±**
- `/ls`: æŸ¥çœ‹èƒŒåŒ…
- ç‰©å“åˆ†é¡é¡¯ç¤º
- éš±ç§æ¬Šè¨­å®š

### ğŸµ éŸ³æ¨‚ç³»çµ±

#### æ”¯æ´çš„æŒ‡ä»¤

| æŒ‡ä»¤ | åŠŸèƒ½ | èªªæ˜ |
|------|------|------|
| `/play <query>` | æ’­æ”¾éŸ³æ¨‚ | æœå°‹ä¸¦æ’­æ”¾ |
| `/pause` | æš«åœ | æš«åœç•¶å‰æ’­æ”¾ |
| `/resume` | ç¹¼çºŒ | ç¹¼çºŒæ’­æ”¾ |
| `/skip` | è·³é | è·³éç•¶å‰æ­Œæ›² |
| `/queue` | ä½‡åˆ— | æŸ¥çœ‹æ’­æ”¾ä½‡åˆ— |
| `/nowplaying` | æ­£åœ¨æ’­æ”¾ | é¡¯ç¤ºç•¶å‰æ­Œæ›² |
| `/join` | åŠ å…¥ | åŠ å…¥èªéŸ³é »é“ |
| `/disconnect` | é›¢é–‹ | é›¢é–‹èªéŸ³é »é“ |
| `/swap <a> <b>` | äº¤æ› | äº¤æ›ä½‡åˆ—é †åº |

#### æ’­æ”¾æµç¨‹

```
ç”¨æˆ¶åŸ·è¡Œ /play <query>
    â†“
search_until() æœå°‹éŸ³æ¨‚
    â†“
å‰µå»º MusicTrack ç‰©ä»¶
    â†“
getQueue() å–å¾—æˆ–å‰µå»ºä½‡åˆ—
    â†“
addOrPlay() åŠ å…¥ä½‡åˆ—æˆ–ç›´æ¥æ’­æ”¾
    â†“
prepareStream() æº–å‚™éŸ³è¨Šä¸²æµ
    â†“
createAudioResource() å‰µå»ºéŸ³è¨Šè³‡æº
    â†“
player.play() é–‹å§‹æ’­æ”¾
    â†“
ç™¼é€ã€Œæ­£åœ¨æ’­æ”¾ã€è¨Šæ¯
```

### âš™ï¸ ç®¡ç†åŠŸèƒ½

#### å‹•æ…‹èªéŸ³é »é“

**åŠŸèƒ½**: è‡ªå‹•å‰µå»ºå’Œåˆªé™¤è‡¨æ™‚èªéŸ³é »é“

- ç”¨æˆ¶åŠ å…¥ç‰¹å®šé »é“æ™‚è‡ªå‹•å‰µå»ºå°ˆå±¬èªéŸ³é »é“
- ç”¨æˆ¶é›¢é–‹å¾Œè‡ªå‹•åˆªé™¤ç©ºé »é“
- å¯è¨­å®šé »é“åç¨±æ ¼å¼

#### å‰ç¶´ç³»çµ±

- æ”¯æ´å¤šå€‹è‡ªè¨‚å‰ç¶´
- ä¿ç•™å‰ç¶´ç³»çµ± (é è¨­å‰ç¶´ç„¡æ³•åˆªé™¤)
- ä¼ºæœå™¨ç¨ç«‹é…ç½®

---

## è³‡æ–™åº«ç³»çµ±

### ğŸ“Š è³‡æ–™åº«æ¶æ§‹

ä½¿ç”¨ **JSON**  ä½œç‚ºæœ¬åœ°è³‡æ–™åº«ã€‚

#### è³‡æ–™åº«æª”æ¡ˆçµæ§‹

```
db/
â”œâ”€â”€ guilds/              # ä¼ºæœå™¨è³‡æ–™åº«
â”‚   â””â”€â”€ {guildID}.db    # æ¯å€‹ä¼ºæœå™¨ä¸€å€‹è³‡æ–™åº«
â”œâ”€â”€ users/               # ç”¨æˆ¶è³‡æ–™åº«
â”‚   â””â”€â”€ {userID}.db     # æ¯å€‹ç”¨æˆ¶ä¸€å€‹è³‡æ–™åº«
â””â”€â”€ rpg/                 # RPG è³‡æ–™åº«
```

### ğŸ”„ è³‡æ–™åº«æ“ä½œ

**æª”æ¡ˆä½ç½®**: `utils/file.js`

```javascript
// è¼‰å…¥ RPG è³‡æ–™
async load_rpg_data(userID)
    â†’ è¿”å›ç”¨æˆ¶çš„ RPG è³‡æ–™ç‰©ä»¶

// å„²å­˜ RPG è³‡æ–™
async save_rpg_data(userID, data)
    â†’ å°‡è³‡æ–™å¯«å…¥è³‡æ–™åº«

// è¼‰å…¥ä¼ºæœå™¨è³‡æ–™
async loadData(guildID)
    â†’ è¿”å›ä¼ºæœå™¨é…ç½®

// å„²å­˜ä¼ºæœå™¨è³‡æ–™
async saveData(guildID, data)
    â†’ æ›´æ–°ä¼ºæœå™¨é…ç½®
```

### ğŸ›¡ï¸ è³‡æ–™ä¿è­·

**1. å®šæœŸå‚™ä»½** (`schedule/every5min/upload_db_files.js`)
- æ¯5åˆ†é˜ä¸Šå‚³è³‡æ–™åº«è‡³ç·šä¸Šå„²å­˜
- é˜²æ­¢è³‡æ–™éºå¤±

**2. è³‡æ–™å®Œæ•´æ€§æª¢æŸ¥** (`schedule/every5min/fix_user_rpg_database.js`)
- æª¢æŸ¥ä¸¦ä¿®å¾©æå£çš„è³‡æ–™
- ç¢ºä¿è³‡æ–™çµæ§‹æ­£ç¢º

**3. éŒ¯èª¤è™•ç†**
- æ‰€æœ‰è³‡æ–™åº«æ“ä½œéƒ½æœ‰éŒ¯èª¤æ•ç²
- è³‡æ–™åº«é–å®šæ©Ÿåˆ¶é˜²æ­¢ä½µç™¼å¯«å…¥

---

## é–‹ç™¼æŒ‡å—

### ğŸ”§ æ–°å¢æ–œç·šæŒ‡ä»¤

1. **å»ºç«‹æŒ‡ä»¤æª”æ¡ˆ**

åœ¨ `slashcmd/` ç›®éŒ„ä¸‹å»ºç«‹æ–°æª”æ¡ˆï¼Œä¾‹å¦‚ `slashcmd/test.js`:

```javascript
const { SlashCommandBuilder } = require("discord.js");

module.exports = {
    data: new SlashCommandBuilder()
        .setName("test")
        .setDescription("æ¸¬è©¦æŒ‡ä»¤"),
    
    async execute(interaction, client) {
        await interaction.reply("æ¸¬è©¦æˆåŠŸï¼");
    }
};
```

2. **é‡å•Ÿæ©Ÿå™¨äºº**

æŒ‡ä»¤æœƒè‡ªå‹•è¨»å†Š (é€é `utils/auto_register.js`)

### ğŸ¯ æ–°å¢ Cog (äº‹ä»¶è™•ç†å™¨)

1. **å»ºç«‹ Cog æª”æ¡ˆ**

åœ¨ `cogs/` ç›®éŒ„ä¸‹å»ºç«‹æª”æ¡ˆï¼Œä¾‹å¦‚ `cogs/my_event.js`:

```javascript
const { Events } = require("discord.js");

module.exports = {
    name: Events.MessageCreate,  // Discord äº‹ä»¶åç¨±
    
    async execute(client, message) {
        // è™•ç†é‚è¼¯
        if (message.content === "ping") {
            await message.reply("pong!");
        }
    }
};
```

2. **é‡å•Ÿæ©Ÿå™¨äºº**

Cog æœƒè‡ªå‹•è¼‰å…¥ (é€é `utils/load_cogs.js`)

### â° æ–°å¢æ’ç¨‹ä»»å‹™

1. **å»ºç«‹æ’ç¨‹æª”æ¡ˆ**

æ ¹æ“šåŸ·è¡Œé »ç‡é¸æ“‡ç›®éŒ„ï¼š
- `schedule/everysec/` - æ¯ç§’
- `schedule/everymin/` - æ¯åˆ†é˜
- `schedule/every5min/` - æ¯5åˆ†é˜

ä¾‹å¦‚ `schedule/everymin/my_task.js`:

```javascript
module.exports = {
    async execute(client) {
        console.log("æ¯åˆ†é˜åŸ·è¡Œçš„ä»»å‹™");
        
        // åŸ·è¡Œä»»å‹™é‚è¼¯
        // ä¾‹å¦‚ï¼šæ¸…ç†éæœŸè³‡æ–™ã€ç™¼é€é€šçŸ¥ç­‰
    }
};
```

2. **é‡å•Ÿæ©Ÿå™¨äºº**

æ’ç¨‹æœƒè‡ªå‹•è¨»å†Šä¸¦åŸ·è¡Œ

### ğŸ“ ç¨‹å¼ç¢¼è¦ç¯„

#### å‘½åè¦ç¯„

```javascript
// æª”æ¡ˆåç¨±ï¼šå°å¯« + åº•ç·š
// utils/load_cogs.js âœ“
// utils/LoadCogs.js âœ—

// å‡½æ•¸åç¨±ï¼šé§å³°å¼
async loadData(guildID) { ... }  âœ“
async load_data(guildID) { ... }  âœ—

// é¡åˆ¥åç¨±ï¼šPascal Case
class DogClient { ... }  âœ“
class dogClient { ... }  âœ—

// å¸¸æ•¸ï¼šå…¨å¤§å¯« + åº•ç·š
const MAX_USERS = 100;  âœ“
const maxUsers = 100;   âœ—
```

#### éŒ¯èª¤è™•ç†

```javascript
// ä½¿ç”¨ try-catch åŒ…è£¹å¯èƒ½å‡ºéŒ¯çš„ä»£ç¢¼
try {
    await someAsyncFunction();
} catch (error) {
    const logger = get_logger();
    logger.error(`éŒ¯èª¤: ${error.stack}`);
}
```

#### æ—¥èªŒè¨˜éŒ„

```javascript
const { get_logger } = require("./utils/logger.js");
const logger = get_logger();

logger.info("è³‡è¨Šè¨Šæ¯");
logger.warn("è­¦å‘Šè¨Šæ¯");
logger.error("éŒ¯èª¤è¨Šæ¯");
logger.debug("é™¤éŒ¯è¨Šæ¯");
```

### ğŸ§ª æ¸¬è©¦

```bash
# åŸ·è¡Œæ¸¬è©¦
npm test

# æª¢æŸ¥å¾ªç’°ä¾è³´
npm run check-deps
```

### ğŸ› é™¤éŒ¯æŠ€å·§

**1. å•Ÿç”¨ Debug æ¨¡å¼**

åœ¨ `index.js` ä¸­è¨­å®šï¼š
```javascript
const args = process.argv.slice(2);
const debug = args.includes("--debug");
```

åŸ·è¡Œï¼š
```bash
node index.js --debug
```

**2. æª¢æŸ¥éŸ³æ¨‚æ’­æ”¾å™¨ç‹€æ…‹**

åœ¨é‹è¡Œä¸­çš„æ©Ÿå™¨äººå‘½ä»¤åˆ—è¼¸å…¥ï¼š
```
music      # æŸ¥çœ‹æ’­æ”¾å™¨çµ±è¨ˆ
musicd 5   # æŸ¥çœ‹è©³ç´°è³‡è¨Š (æ·±åº¦ 5)
```

**3. æŸ¥çœ‹æ—¥èªŒ**

æ—¥èªŒä½¿ç”¨ Winston è¨˜éŒ„ï¼Œæª¢æŸ¥æ§åˆ¶å°è¼¸å‡º

### ğŸ” å®‰å…¨æ€§å»ºè­°

1. **çµ•å°ä¸è¦å°‡ `.env` æª”æ¡ˆæäº¤è‡³ Git**
   - å·²åœ¨ `.gitignore` ä¸­æ’é™¤

2. **å®šæœŸæ›´æ–°ä¾è³´**
   ```bash
   npm update
   npm audit fix
   ```

3. **ä½¿ç”¨ç’°å¢ƒè®Šæ•¸ç®¡ç†æ•æ„Ÿè³‡è¨Š**
   - Tokenã€API Keys ç­‰éƒ½æ‡‰æ”¾åœ¨ `.env`

4. **æ¬Šé™æœ€å°åŒ–åŸå‰‡**
   - åªçµ¦æ©Ÿå™¨äººå¿…è¦çš„ Discord æ¬Šé™

### ğŸ“š å¸¸è¦‹å•é¡Œ

**Q: éŸ³æ¨‚ç„¡æ³•æ’­æ”¾ï¼Ÿ**
- ç¢ºèªå·²å®‰è£ FFmpeg
- æª¢æŸ¥æ©Ÿå™¨äººæ˜¯å¦æœ‰é€£æ¥èªéŸ³é »é“æ¬Šé™
- ç¢ºèªéŸ³æ¨‚ä¾†æº (SoundCloud) æ˜¯å¦å¯è¨ªå•

**Q: RPG è³‡æ–™éºå¤±ï¼Ÿ**
- æª¢æŸ¥ `db/rpg/` ç›®éŒ„æ˜¯å¦å­˜åœ¨
- æŸ¥çœ‹å‚™ä»½æ˜¯å¦æ­£å¸¸é‹ä½œ (`upload_db_files.js`)
- ä½¿ç”¨ `database_recovery/main.py` æ¢å¾©è³‡æ–™

**Q: æŒ‡ä»¤ç„¡æ³•è¨»å†Šï¼Ÿ**
- ç¢ºèª `.env` ä¸­çš„ `CLIENT_ID` æ­£ç¢º
- æª¢æŸ¥ Discord Developer Portal ä¸­çš„ Bot è¨­å®š
- å˜—è©¦æ‰‹å‹•åŸ·è¡Œ `node register_commands.js`

**Q: æ©Ÿå™¨äººé›¢ç·šï¼Ÿ**
- æª¢æŸ¥ç¶²è·¯é€£æ¥
- ç¢ºèª Token æ˜¯å¦æœ‰æ•ˆ
- æŸ¥çœ‹æ—¥èªŒä¸­çš„éŒ¯èª¤è¨Šæ¯
- æª¢æŸ¥ Discord API ç‹€æ…‹

### ğŸš€ æ•ˆèƒ½å„ªåŒ–å»ºè­°

1. **å¿«å–ç®¡ç†**
   - å·²å¯¦ä½œè‡ªå‹•æ¸…ç†æ©Ÿåˆ¶ (Sweepers)
   - å®šæœŸæ¸…ç†ä¸æ´»èºçš„å¿«å–

2. **è³‡æ–™åº«å„ªåŒ–**
   - ä½¿ç”¨ç´¢å¼•åŠ é€ŸæŸ¥è©¢
   - æ‰¹æ¬¡è™•ç†å¤§é‡è³‡æ–™æ“ä½œ

3. **è¨˜æ†¶é«”ç›£æ§**
   - `index.js` å·²å¯¦ä½œè¨˜æ†¶é«”è­¦å‘Šæ©Ÿåˆ¶
   - è¶…é 500MB æ™‚ç™¼å‡ºè­¦å‘Š

4. **CPU ç›£æ§**
   - æ¯30ç§’æª¢æŸ¥ä¸€æ¬¡ CPU ä½¿ç”¨ç‡
   - è¶…é 80% æ™‚è¨˜éŒ„è­¦å‘Š

---

## ğŸ“„ æˆæ¬Š

æœ¬å°ˆæ¡ˆä½¿ç”¨ **MIT License**

---

## ğŸ¤ è²¢ç»æŒ‡å—

1. Fork å°ˆæ¡ˆ
2. å»ºç«‹åŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤è®Šæ›´ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. é–‹å•Ÿ Pull Request

---

## ğŸ“ è¯çµ¡è³‡è¨Š

- **å°ˆæ¡ˆå„²å­˜åº«**: https://github.com/hugohugo130/DogBot
- **Discord**: åŠ å…¥æ”¯æ´ä¼ºæœå™¨å–å¾—å”åŠ©

---

## ğŸ“Œ ç‰ˆæœ¬æ­·å²

### v1.0.0 (ç•¶å‰ç‰ˆæœ¬)
- âœ… å®Œæ•´çš„ RPG éŠæˆ²ç³»çµ±
- âœ… éŸ³æ¨‚æ’­æ”¾åŠŸèƒ½
- âœ… ä¼ºæœå™¨ç®¡ç†åŠŸèƒ½
- âœ… æ’ç¨‹ç³»çµ±
- âœ… è³‡æ–™åº«å‚™ä»½

---

**æ–‡æª”æœ€å¾Œæ›´æ–°**: 2026/2/2
**æ–‡æª”ç‰ˆæœ¬**: 1.0.0
**å°ˆæ¡ˆç‰ˆæœ¬**: 1.0.0

---
